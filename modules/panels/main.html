<div id=D__ID>
    <div id=panel__ID>
        <div>
            <b>Search</b>
            <ul>
                <li><a href="?/research-studies">Research Studies</a></li>
                <li><a href="?/contacts">Contacts</a></li>
            </ul>
        </div>
        <div>
            <b>Count</b>
            <ul>
                <li><a href="?/count-contacts">How many contacts?</a><span id=count_contacts__ID></span></li>
                <li><a href="?/count-studes">How many studies?</a><span id=count_studies__ID></span></li>
                <li><a href="?/count-newsletters">How many contacts who subscribed the newsletter?</a><span id=count_newsletters__ID></span></li>
            </ul>
        </div>
    </div>
    <script>
        function F__ID(){
            //--------------------------------------------------------
            $('#panel__ID').css('min-height',$vm.min_height);
            //--------------------------------------------------------
            $('#D__ID a').on('click',function(e){
                e.preventDefault();
                e.stopPropagation();
                var module_name=$(this).attr('href').replace('?\/','');
                switch(module_name){
                    case "count-contacts": query_contacts(); break;
                    case "count-studes": query_studies(); break;
                    case "count-newsletters": query_newsletters(); break;
                    default: if(module_name!="") $vm.show_module(module_name,{}); break;
                }
                //if(module_name!="") $vm.show_module(module_name,{})
            })
            //---------------------------------------------------------------
            var query_contacts=function(){
                var path="/api/data/v9.1/RetrieveTotalRecordCount(EntityNames=['contact'])"
                $vm.get_microsoft_data(path,function(status,data){
                    if(status==200){
                        var jD=JSON.parse(data);
                        var n=jD["EntityRecordCountCollection"]["Values"][0];
                        $('#count_contacts__ID').text(n);
                    }
                    else alert("Error: "+status);
                })
            }
            //---------------------------------------------------------------
            var query_studies=function(){
                var path="/api/data/v9.1/RetrieveTotalRecordCount(EntityNames=['woolcock_study'])"
                $vm.get_microsoft_data(path,function(status,data){
                    if(status==200){
                        var jD=JSON.parse(data);
                        var n=jD["EntityRecordCountCollection"]["Values"][0];
                        $('#count_studies__ID').text(n);
                    }
                    else alert("Error: "+status);
                })
            }
            //---------------------------------------------------------------
            var query_newsletters=function(){
                var path="/api/data/v9.1/contacts?$count=true&$filter=woolcock_newsletter eq true"
                $vm.get_microsoft_data(path,function(status,data){
                    if(status==200){
                        var jD=JSON.parse(data);
                        console.log(jD)
                        //var n=jD["EntityRecordCountCollection"]["Values"][0];
                        //$('#count_studies__ID').text(n);
                    }
                    else alert("Error: "+status);
                })
            }
            //---------------------------------------------------------------
            "path":"/api/data/v9.1/contacts?$count=true&$filter=woolcock_newsletter eq true",


        }
    </script>
    <style>
        #D__ID{
            height:100%;
            background-color: #fff;
        }
        #panel__ID{
            padding:50px 100px;

            display: grid;
            grid-template-columns: auto auto auto auto;
            grid-gap: 10px;

        }

        #panel__ID li a{
            color:#555;
            text-decoration: none;
            margin-right:20px;
        }
        #panel__ID li i{
            color:#ccc;
            font-size:80%;
        }
        
        #_panel__ID li a:link{
            color:#555;
        }
        #panel__ID li a:visited{
            color:#555;
        }
        #panel__ID li a:hover{
            color:red;
        }
        #panel__ID li a:hover i{
            color:red;
        }

        @media screen and (max-width: 1200px) {
            #panel__ID{
                padding:10px 10px;
            }
        }
    </style>
</div>
